# Business Logic Vulnerabilities
* 商業邏輯漏洞，是指應用程式設計的缺陷，允許攻擊者引發意外行為。
## 成因
* 開發團隊不完全理解所開發的系統。
* 導致對用戶如何與應用程式互動，做出了錯誤的假設。
* 因此錯誤的假設，導致對用戶輸入的驗證不充分。
* 最終允許攻擊者透過一些特別的手法，繞過驗證機制，來達成攻擊目標。
## 案例
* **過度信任使用者輸入**
    * 攻擊者可以透過攔截請求，繞過前端驗證，修改與刪除欄位。
* **未處理異常輸入**
    * 未處理異常的輸入長度。
        * 數值可以超出長度限制，導致數值溢位。 (ex. int: -2147483648 ~ 2147483647)
        * 字數可以超出長度長度限制，導致字串截斷。 (ex. 字數 <= 255)
* **使用者不會總是遵循預期的順序**
    * 攻擊者可以透過跳過或重傳的方式，打破原本設計的流程。
* **特定領域的缺陷**
    * 像是網站販賣點數券(1張10點，售價10元，1點=1元)，但點數券卻可以使用折價券(折價 30%)來打折。
    * 因此我們可以買一張點數券，並使用用折價券折價 30%，因此只需付 7 元，但是卻得到價值10元的點數券，最終淨賺3元。
* **encryption oracle**
    * 用戶可以控制輸入加密並且生成的密文。
## 防禦
* 確保開發和測試人員了解應用程式服務的領域。
* 避免對用戶行為或應用程式其他部分的行為做出隱含的假設。
---
###### tags: `web security`